
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{mp2}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\begin{itemize}
\tightlist
\item
  Team member names: Hetsvi Navnitlal and Emily Kwan
\item
  Team member IDs: A13595252, A14075665
\end{itemize}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

    \hypertarget{mini-project-2-dsc-170-spring-2019}{%
\section{Mini-project 2, DSC 170, Spring
2019}\label{mini-project-2-dsc-170-spring-2019}}

\hypertarget{advanced-geopandas-spatial-join-and-geoprocessing}{%
\subsection{Advanced Geopandas: spatial join and
geoprocessing}\label{advanced-geopandas-spatial-join-and-geoprocessing}}

    In this mini-project, you will explore several common geospatial
computations. The goal is to practice with different types of requests
against a single layer, and then work on joining several data layers
using real data. The goal is to demonstrate your geopandas mastery, and
also to show that you can discover datasets and critically evaluate
metadata.

For each dataset that you found and used, explore its metadata and
provide a brief description (about 3 sentences): indicate its title,
URL, number of records, coordinate reference system, the manner in which
it was compiled (as far as you can tell from the metadata), and any data
quality considerations, especially those that may influence geometric
processing.

There will be one relatively simple warm-up problem, and one larger and
very real problem that the City of San Diego is struggling with. The
best creative solutions to the second one will be demonstrated when
Scale-SD folks come here to give an invited talk.

Note that the upload file size limit has been removed from the datahub,
so you should be able to upload your data.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline 
        \PY{k+kn}{import} \PY{n+nn}{geopandas} \PY{k}{as} \PY{n+nn}{gpd}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        
        \PY{c+c1}{\PYZsh{} add packages as needed}
        
        \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{n}{current\PYZus{}dir} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{getcwd}\PY{p}{(}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{current\PYZus{}dir}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/datasets/home/home-03/88/788/hnavnitl/MP2

    \end{Verbatim}

    \begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\textbf{Problem 1}.

In an administrative boundaries map of California (find it as a GeoJSON
or a shapefile on one of the web sites), find a county named San Diego
and return its CRS, polygon coordinates, area (in sq miles), bounding
box (in latitude and longitude), and a list of neighboring counties.

Generally speaking, this will be a function to return geometric
characteristics and neighbors of any polygon in an input dataframe
(input\_gdf) with a given name (poly\_name) in a specific column
(poly\_name\_field). Most lilely, in the database you find there will be
a unique ``San Diego'' record - but it won't harm to do dissolve, just
in case.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ poly_geometry(input_gdf, poly_name_field, poly_name):}

\CommentTok{# YOUR CODE HERE}

    \ControlFlowTok{return}\NormalTok{ crs, poly_coords, area, bounding_box, neighbors}
\end{Highlighting}
\end{Shaded}

    \hypertarget{solution-for-problem-1-code-and-dataset-description}{%
\subsubsection{Solution for problem 1: code and dataset
description:}\label{solution-for-problem-1-code-and-dataset-description}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{} problem 1 solution stud code}
        \PY{k}{def} \PY{n+nf}{poly\PYZus{}geometry}\PY{p}{(}\PY{n}{input\PYZus{}gdf}\PY{p}{,} \PY{n}{poly\PYZus{}name\PYZus{}field}\PY{p}{,} \PY{n}{poly\PYZus{}name}\PY{p}{)}\PY{p}{:}
        
        \PY{c+c1}{\PYZsh{} YOUR CODE HERE}
        
            \PY{k}{return} \PY{n}{crs}\PY{p}{,} \PY{n}{poly\PYZus{}coords}\PY{p}{,} \PY{n}{area}\PY{p}{,} \PY{n}{bounding\PYZus{}box}\PY{p}{,} \PY{n}{neighbors}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{shpFileIn} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../CA\PYZus{}Counties\PYZus{}TIGER2016.shp}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{sd\PYZus{}parks} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{n}{shpFileIn}\PY{p}{)}
        \PY{n}{sd\PYZus{}parks}\PY{o}{.}\PY{n}{info}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:} <bound method DataFrame.info of    STATEFP COUNTYFP  COUNTYNS  GEOID             NAME                NAMELSAD  \textbackslash{}
        0       06      091  00277310  06091           Sierra           Sierra County   
        1       06      067  00277298  06067       Sacramento       Sacramento County   
        2       06      083  00277306  06083    Santa Barbara    Santa Barbara County   
        3       06      009  01675885  06009        Calaveras        Calaveras County   
        4       06      111  00277320  06111          Ventura          Ventura County   
        5       06      037  00277283  06037      Los Angeles      Los Angeles County   
        6       06      097  01657246  06097           Sonoma           Sonoma County   
        7       06      031  00277280  06031            Kings            Kings County   
        8       06      073  00277301  06073        San Diego        San Diego County   
        9       06      061  00277295  06061           Placer           Placer County   
        10      06      075  00277302  06075    San Francisco    San Francisco County   
        11      06      041  00277285  06041            Marin            Marin County   
        12      06      043  00277286  06043         Mariposa         Mariposa County   
        13      06      035  01693324  06035           Lassen           Lassen County   
        14      06      055  00277292  06055             Napa             Napa County   
        15      06      089  01682610  06089           Shasta           Shasta County   
        16      06      053  00277291  06053         Monterey         Monterey County   
        17      06      105  00277317  06105          Trinity          Trinity County   
        18      06      045  00277287  06045        Mendocino        Mendocino County   
        19      06      027  01804637  06027             Inyo             Inyo County   
        20      06      051  00277290  06051             Mono             Mono County   
        21      06      109  00277319  06109         Tuolumne         Tuolumne County   
        22      06      095  00277312  06095           Solano           Solano County   
        23      06      071  00277300  06071   San Bernardino   San Bernardino County   
        24      06      013  01675903  06013     Contra Costa     Contra Costa County   
        25      06      003  01675840  06003           Alpine           Alpine County   
        26      06      017  00277273  06017        El Dorado        El Dorado County   
        27      06      113  00277321  06113             Yolo             Yolo County   
        28      06      115  00277322  06115             Yuba             Yuba County   
        29      06      069  00277299  06069       San Benito       San Benito County   
        30      06      023  01681908  06023         Humboldt         Humboldt County   
        31      06      065  00277297  06065        Riverside        Riverside County   
        32      06      029  02054176  06029             Kern             Kern County   
        33      06      011  01675902  06011           Colusa           Colusa County   
        34      06      015  01682074  06015        Del Norte        Del Norte County   
        35      06      049  00277289  06049            Modoc            Modoc County   
        36      06      019  00277274  06019           Fresno           Fresno County   
        37      06      039  00277284  06039           Madera           Madera County   
        38      06      085  00277307  06085      Santa Clara      Santa Clara County   
        39      06      103  01692767  06103           Tehama           Tehama County   
        40      06      077  00277303  06077      San Joaquin      San Joaquin County   
        41      06      001  01675839  06001          Alameda          Alameda County   
        42      06      057  01682927  06057           Nevada           Nevada County   
        43      06      007  01675842  06007            Butte            Butte County   
        44      06      047  00277288  06047           Merced           Merced County   
        45      06      107  00277318  06107           Tulare           Tulare County   
        46      06      099  00277314  06099       Stanislaus       Stanislaus County   
        47      06      059  00277294  06059           Orange           Orange County   
        48      06      025  00277277  06025         Imperial         Imperial County   
        49      06      101  00277315  06101           Sutter           Sutter County   
        50      06      005  01675841  06005           Amador           Amador County   
        51      06      033  00277281  06033             Lake             Lake County   
        52      06      063  00277296  06063           Plumas           Plumas County   
        53      06      081  00277305  06081        San Mateo        San Mateo County   
        54      06      093  00277311  06093         Siskiyou         Siskiyou County   
        55      06      087  00277308  06087       Santa Cruz       Santa Cruz County   
        56      06      021  00277275  06021            Glenn            Glenn County   
        57      06      079  00277304  06079  San Luis Obispo  San Luis Obispo County   
        
           LSAD CLASSFP  MTFCC CSAFP CBSAFP METDIVFP FUNCSTAT        ALAND  \textbackslash{}
        0    06      H1  G4020  None   None     None        A   2468694587   
        1    06      H1  G4020   472  40900     None        A   2499183617   
        2    06      H1  G4020  None  42200     None        A   7084000598   
        3    06      H1  G4020  None   None     None        A   2641820834   
        4    06      H1  G4020   348  37100     None        A   4773390489   
        5    06      H1  G4020   348  31080    31084        A  10510651024   
        6    06      H1  G4020   488  42220     None        A   4081437574   
        7    06      H1  G4020   546  25260     None        A   3598583450   
        8    06      H1  G4020  None  41740     None        A  10895149811   
        9    06      H1  G4020   472  40900     None        A   3644333049   
        10   06      H6  G4020   488  41860    41884        C    121455687   
        11   06      H1  G4020   488  41860    42034        A   1348061297   
        12   06      H1  G4020  None   None     None        A   3752420463   
        13   06      H1  G4020  None  45000     None        A  11761603010   
        14   06      H1  G4020   488  34900     None        A   1938165958   
        15   06      H1  G4020   454  39820     None        A   9778179454   
        16   06      H1  G4020  None  41500     None        A   8496669426   
        17   06      H1  G4020  None   None     None        A   8234265201   
        18   06      H1  G4020  None  46380     None        A   9081421729   
        19   06      H1  G4020  None   None     None        A  26368508405   
        20   06      H1  G4020  None   None     None        A   7896839510   
        21   06      H1  G4020  None  43760     None        A   5752184086   
        22   06      H1  G4020   488  46700     None        A   2128380148   
        23   06      H1  G4020   348  40140     None        A  51948120575   
        24   06      H1  G4020   488  41860    36084        A   1871930816   
        25   06      H1  G4020  None   None     None        A   1912292633   
        26   06      H1  G4020   472  40900     None        A   4423349463   
        27   06      H1  G4020   472  40900     None        A   2628256658   
        28   06      H1  G4020   472  49700     None        A   1636971148   
        29   06      H1  G4020   488  41940     None        A   3596755292   
        30   06      H1  G4020  None  21700     None        A   9240992572   
        31   06      H1  G4020   348  40140     None        A  18664206749   
        32   06      H1  G4020  None  12540     None        A  21061589620   
        33   06      H1  G4020  None   None     None        A   2980372757   
        34   06      H1  G4020  None  18860     None        A   2606100217   
        35   06      H1  G4020  None   None     None        A  10140955630   
        36   06      H1  G4020   260  23420     None        A  15433177265   
        37   06      H1  G4020   260  31460     None        A   5535098260   
        38   06      H1  G4020   488  41940     None        A   3344210021   
        39   06      H1  G4020   454  39780     None        A   7639720404   
        40   06      H1  G4020   488  44700     None        A   3606276598   
        41   06      H1  G4020   488  41860    36084        A   1914242789   
        42   06      H1  G4020   472  46020     None        A   2480606160   
        43   06      H1  G4020  None  17020     None        A   4238423343   
        44   06      H1  G4020   382  32900     None        A   5012175306   
        45   06      H1  G4020   546  47300     None        A  12495016292   
        46   06      H1  G4020   382  33700     None        A   3874642752   
        47   06      H1  G4020   348  31080    11244        A   2047702298   
        48   06      H1  G4020  None  20940     None        A  10817291640   
        49   06      H1  G4020   472  49700     None        A   1560255999   
        50   06      H1  G4020  None   None     None        A   1539933576   
        51   06      H1  G4020  None  17340     None        A   3254288286   
        52   06      H1  G4020  None   None     None        A   6612400993   
        53   06      H1  G4020   488  41860    41884        A   1161658961   
        54   06      H1  G4020  None   None     None        A  16261974847   
        55   06      H1  G4020   488  42100     None        A   1152967330   
        56   06      H1  G4020  None   None     None        A   3403104376   
        57   06      H1  G4020  None  42020     None        A   8548640337   
        
                AWATER     INTPTLAT      INTPTLON  \textbackslash{}
        0     23299110  +39.5769252  -120.5219926   
        1     76073827  +38.4500114  -121.3404409   
        2   2729814515  +34.5370572  -120.0399729   
        3     43806026  +38.1838996  -120.5614415   
        4    945942791  +34.3587415  -119.1331432   
        5   1794730436  +34.1963983  -118.2618616   
        6    497508807  +38.5251824  -122.9261095   
        7      5468555  +36.0724780  -119.8155301   
        8    826195031  +33.0236041  -116.7761174   
        9    246486852  +39.0620323  -120.7227181   
        10   479136515  +37.7272391  -123.0322294   
        11   796944835  +38.0518169  -122.7459738   
        12    36268135  +37.5700335  -119.9128599   
        13   463438616  +40.7210862  -120.6299518   
        14   104249021  +38.5070999  -122.3259045   
        15   186530168  +40.7605142  -122.0435556   
        16  1270747469  +36.2401070  -121.3155723   
        17    73407949  +40.6477241  -123.1144043   
        18   962951511  +39.4323876  -123.4428811   
        19   119088171  +36.5619770  -117.4039269   
        20   214694734  +37.9158363  -118.8751668   
        21   138627184  +38.0214344  -119.9647335   
        22   218647027  +38.2672255  -121.9395940   
        23   123845026  +34.8572198  -116.1811967   
        24   209819213  +37.9194790  -121.9515431   
        25    12557304  +38.6217831  -119.7983522   
        26   203269403  +38.7855320  -120.5343981   
        27    22688574  +38.6795954  -121.9024412   
        28    31000614  +39.2662469  -121.3407809   
        29     4555000  +36.6107024  -121.0852960   
        30  1254297982  +40.7066731  -123.9258181   
        31   250926952  +33.7298275  -116.0022389   
        32    79574760  +35.3466288  -118.7295064   
        33    14581043  +39.1777385  -122.2375629   
        34   578760364  +41.7499033  -123.9809983   
        35   745425201  +41.5929185  -120.7183704   
        36   135374444  +36.7610058  -119.6550193   
        37    41957139  +37.2098213  -119.7498023   
        38    33276429  +37.2207774  -121.6906224   
        39    32276063  +40.1261561  -122.2322757   
        40    89025932  +37.9349815  -121.2722440   
        41   212979931  +37.6471385  -121.9124880   
        42    41513172  +39.2975082  -120.7713429   
        43   105325812  +39.6659588  -121.6019188   
        44   112509475  +37.1948063  -120.7228019   
        45    37081410  +36.2288241  -118.7810610   
        46    46376455  +37.5623162  -121.0028311   
        47   407606601  +33.6756872  -117.7772068   
        48   790230304  +33.0408143  -115.3554001   
        49    15724974  +39.0361898  -121.7039397   
        50    29470568  +38.4435501  -120.6538563   
        51   188912510  +39.0948019  -122.7467569   
        52   156387635  +39.9922953  -120.8243709   
        53   757412213  +37.4146633  -122.3715451   
        54   179108278  +41.5879861  -122.5332868   
        55   419570389  +37.0124883  -122.0072050   
        56    33749275  +39.6025462  -122.4016998   
        57   815490673  +35.3852242  -120.4475445   
        
                                                     geometry  
        0   POLYGON ((-13431319.75097945 4821511.426395644{\ldots}  
        1   POLYGON ((-13490651.47641084 4680831.603393857{\ldots}  
        2   (POLYGON ((-13423116.77225655 4042044.14856006{\ldots}  
        3   POLYGON ((-13428575.483353 4627725.227535474, {\ldots}  
        4   (POLYGON ((-13317853.59433417 3931602.41399276{\ldots}  
        5   (POLYGON ((-13210018.38774803 3958856.14118129{\ldots}  
        6   POLYGON ((-13685069.7665829 4623872.83235519, {\ldots}  
        7   POLYGON ((-13353767.85744708 4335831.239496617{\ldots}  
        8   POLYGON ((-13073075.79626082 3919158.523585408{\ldots}  
        9   POLYGON ((-13476944.15285243 4722608.14952577,{\ldots}  
        10  (POLYGON ((-13647797.31711963 4551561.43335257{\ldots}  
        11  POLYGON ((-13668520.00109493 4563468.19755313,{\ldots}  
        12  POLYGON ((-13394132.4376194 4512456.354436223,{\ldots}  
        13  POLYGON ((-13505494.73731334 4961581.116898506{\ldots}  
        14  POLYGON ((-13632619.3596853 4679532.687733989,{\ldots}  
        15  POLYGON ((-13649470.93976703 4994815.77746377,{\ldots}  
        16  POLYGON ((-13583963.80182884 4376069.357043233{\ldots}  
        17  POLYGON ((-13752851.80528195 4973030.273373823{\ldots}  
        18  POLYGON ((-13785630.37220081 4801473.842514878{\ldots}  
        19  POLYGON ((-13173280.42113141 4391099.816179019{\ldots}  
        20  POLYGON ((-13281407.86005163 4580436.509465723{\ldots}  
        21  POLYGON ((-13414018.0041438 4580009.13323003, {\ldots}  
        22  POLYGON ((-13588190.51437233 4624150.922337844{\ldots}  
        23  POLYGON ((-13098659.03733252 4127837.220416734{\ldots}  
        24  POLYGON ((-13610773.22950815 4565908.501766734{\ldots}  
        25  POLYGON ((-13366503.50758146 4678946.015318793{\ldots}  
        26  POLYGON ((-13482864.23157302 4681232.506745442{\ldots}  
        27  POLYGON ((-13599340.83731083 4670586.673378778{\ldots}  
        28  POLYGON ((-13536192.84958577 4739993.980288644{\ldots}  
        29  POLYGON ((-13523427.36553061 4406408.874225765{\ldots}  
        30  POLYGON ((-13834943.3747943 4982761.91231769, {\ldots}  
        31  POLYGON ((-13099281.75064744 4011348.117300692{\ldots}  
        32  POLYGON ((-13348728.85974443 4223737.153698832{\ldots}  
        33  POLYGON ((-13589905.40684098 4781178.19958951,{\ldots}  
        34  POLYGON ((-13838807.95871344 5120380.773634353{\ldots}  
        35  POLYGON ((-13376085.83106224 5160171.852583427{\ldots}  
        36  POLYGON ((-13325540.6895306 4439078.77993594, {\ldots}  
        37  POLYGON ((-13370183.04282112 4462432.147024411{\ldots}  
        38  POLYGON ((-13585890.86163594 4467090.860872569{\ldots}  
        39  POLYGON ((-13622331.9035064 4920237.777798545,{\ldots}  
        40  POLYGON ((-13492801.94034998 4614635.904178459{\ldots}  
        41  POLYGON ((-13612246.76328248 4538150.085244546{\ldots}  
        42  POLYGON ((-13437793.97916356 4791065.40571715,{\ldots}  
        43  POLYGON ((-13565004.79317821 4798394.124309788{\ldots}  
        44  POLYGON ((-13434214.36240562 4511645.797149388{\ldots}  
        45  POLYGON ((-13225172.00086707 4271812.344158571{\ldots}  
        46  POLYGON ((-13461004.29540267 4542406.638766518{\ldots}  
        47  POLYGON ((-13134488.10155519 3973319.471289119{\ldots}  
        48  POLYGON ((-12839095.42841012 3852391.850631063{\ldots}  
        49  POLYGON ((-13573001.31380904 4750178.637888834{\ldots}  
        50  POLYGON ((-13472697.86293539 4647652.232214323{\ldots}  
        51  POLYGON ((-13699551.22033769 4730153.294886949{\ldots}  
        52  POLYGON ((-13510515.01540707 4877236.694537827{\ldots}  
        53  POLYGON ((-13646335.91187001 4521323.746708268{\ldots}  
        54  POLYGON ((-13677924.00259712 5161573.733656177{\ldots}  
        55  POLYGON ((-13605100.48999848 4469147.1572919, {\ldots}  
        56  POLYGON ((-13680158.03494936 4814470.617666174{\ldots}  
        57  POLYGON ((-13490260.15243948 4272335.748360178{\ldots}  >
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k}{def} \PY{n+nf}{poly\PYZus{}geometry}\PY{p}{(}\PY{n}{input\PYZus{}gdf}\PY{p}{,} \PY{n}{poly\PYZus{}name\PYZus{}field}\PY{p}{,}\PY{n}{poly\PYZus{}name}\PY{p}{)}\PY{p}{:}
            \PY{n}{cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ALAND}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{n}{sub\PYZus{}regions} \PY{o}{=} \PY{n}{input\PYZus{}gdf}\PY{p}{[}\PY{n}{cols}\PY{p}{]}\PY{o}{.}\PY{n}{dissolve}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{as\PYZus{}index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
            \PY{c+c1}{\PYZsh{}print(\PYZdq{}sub\PYZus{}region\PYZdq{}, sub\PYZus{}regions, \PYZdq{}sub\PYZus{}region\PYZdq{})}
            \PY{n}{crs} \PY{o}{=} \PY{n}{sub\PYZus{}regions}\PY{o}{.}\PY{n}{crs}
            \PY{c+c1}{\PYZsh{}print(crs)}
            \PY{n}{sd} \PY{o}{=} \PY{n}{sub\PYZus{}regions}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{sub\PYZus{}regions}\PY{p}{[}\PY{n}{poly\PYZus{}name\PYZus{}field}\PY{p}{]} \PY{o}{==} \PY{n}{poly\PYZus{}name}\PY{p}{]}
            \PY{c+c1}{\PYZsh{}print(sd)}
            \PY{n}{poly\PYZus{}coords} \PY{o}{=} \PY{n}{sd}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{c+c1}{\PYZsh{}print(\PYZdq{}poly\PYZus{}coord\PYZdq{}, poly\PYZus{}coords, \PYZdq{}poly\PYZus{}coord\PYZdq{})}
            \PY{n}{area} \PY{o}{=} \PY{n}{sd}\PY{o}{.}\PY{n}{area}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2590000}\PY{p}{)} \PY{c+c1}{\PYZsh{}sd.ALAND*(0.0015625)}
            \PY{c+c1}{\PYZsh{}print(area)}
            \PY{n}{bounding\PYZus{}box} \PY{o}{=} \PY{n}{sd}\PY{o}{.}\PY{n}{geometry}\PY{o}{.}\PY{n}{bounds}
            \PY{c+c1}{\PYZsh{}print(bounding\PYZus{}box)}
            \PY{c+c1}{\PYZsh{}neighbors = sub\PYZus{}regions[sub\PYZus{}regions.touches(sd.geometry)].NAME.tolist()}
            \PY{n}{sub\PYZus{}regions}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{NEIGHBOURS}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{k+kc}{None}
            \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{rows} \PY{o+ow}{in} \PY{n}{sub\PYZus{}regions}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n}{neighbors} \PY{o}{=} \PY{n}{sub\PYZus{}regions}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sub\PYZus{}regions}\PY{o}{.}\PY{n}{disjoint}\PY{p}{(}\PY{n}{rows}\PY{o}{.}\PY{n}{geometry}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{NAME}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
                \PY{n}{neighbors} \PY{o}{=} \PY{p}{[}\PY{n}{j} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{neighbors} \PY{k}{if} \PY{n}{rows}\PY{o}{.}\PY{n}{NAME} \PY{o}{!=} \PY{n}{j}\PY{p}{]}
                \PY{n}{sub\PYZus{}regions}\PY{o}{.}\PY{n}{at}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{NEIGHBOURS}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{neighbors}\PY{p}{)}
                
            \PY{n}{neighours} \PY{o}{=} \PY{n}{sub\PYZus{}regions}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{sub\PYZus{}regions}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{NAME}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{poly\PYZus{}name}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{NEIGHBOURS}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
            \PY{n}{neighours} \PY{o}{=}\PY{n}{neighours}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{k}{return} \PY{n}{crs}\PY{p}{,} \PY{n}{poly\PYZus{}coords}\PY{p}{,} \PY{n}{area}\PY{p}{,} \PY{n}{bounding\PYZus{}box}\PY{p}{,} \PY{n}{neighours} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{} YOUR CODE HERE}
        \PY{k}{raise} \PY{n+ne}{NotImplementedError}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        NotImplementedError                       Traceback (most recent call last)

        <ipython-input-5-15b94d1fa268> in <module>()
          1 \# YOUR CODE HERE
    ----> 2 raise NotImplementedError()
    

        NotImplementedError: 

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} running the function}
        
        \PY{n}{input\PYZus{}gdf} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../CA\PYZus{}Counties\PYZus{}TIGER2016.shp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{poly\PYZus{}name\PYZus{}field} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NAME}\PY{l+s+s1}{\PYZsq{}}  \PY{c+c1}{\PYZsh{} or whatever is in the file}
        \PY{n}{poly\PYZus{}name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{San Diego}\PY{l+s+s1}{\PYZsq{}} \PY{c+c1}{\PYZsh{} or whatever is in the file}
        
        \PY{n}{crs}\PY{p}{,}\PY{n}{poly\PYZus{}coords}\PY{p}{,}\PY{n}{area}\PY{p}{,}\PY{n}{bbox}\PY{p}{,}\PY{n}{neighbors} \PY{o}{=} \PY{n}{poly\PYZus{}geometry}\PY{p}{(}\PY{n}{input\PYZus{}gdf}\PY{p}{,} \PY{n}{poly\PYZus{}name\PYZus{}field}\PY{p}{,} \PY{n}{poly\PYZus{}name}\PY{p}{)}
        
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{crs}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{poly\PYZus{}coords}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{area}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{bbox}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{neighbors}\PY{p}{)}
\end{Verbatim}


    \textbf{Problem 1 dataset description:}

The title of this dataset is CA County Boundries. The URL for this is
https://data.ca.gov/dataset/ca-geographic-boundaries/resource/091ff50d-bb24-4537-a974-2ce89c6e8663.
This dataset has the county boundries for CA state from the USA census
bureau's 2016 MAF/TIGER database. This data set has 58 records (0-57
index). The coordinate reference system is polygons which is \{`init':
`epsg:3857'\}. According to the metadata we can tell that it was
compiled from the data thats US Census Bureau collectes as a part of the
Master Address File. The unit consistency of the area of the data and
combining similar areas into which fall under one name etc. are some of
the data quality considerations which we had to take care of.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{} running the function}
        
        \PY{n}{input\PYZus{}gdf} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{  your file here  }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{poly\PYZus{}name\PYZus{}field} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Counties}\PY{l+s+s1}{\PYZsq{}}  \PY{c+c1}{\PYZsh{} or whatever is in the file}
        \PY{n}{poly\PYZus{}name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{San Diego}\PY{l+s+s1}{\PYZsq{}} \PY{c+c1}{\PYZsh{} or whatever is in the file}
        
        \PY{n}{crs}\PY{p}{,}\PY{n}{poly\PYZus{}coords}\PY{p}{,}\PY{n}{area}\PY{p}{,}\PY{n}{bbox}\PY{p}{,}\PY{n}{neighbors} \PY{o}{=} \PY{n}{poly\PYZus{}geometry}\PY{p}{(}\PY{n}{input\PYZus{}gdf}\PY{p}{,} \PY{n}{poly\PYZus{}name\PYZus{}field}\PY{p}{,} \PY{n}{poly\PYZus{}name}\PY{p}{)}
        
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{crs}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{poly\PYZus{}coords}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{area}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{bbox}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{neighbors}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        CPLE\_OpenFailedError                      Traceback (most recent call last)

        fiona/\_shim.pyx in fiona.\_shim.gdal\_open\_vector()


        fiona/\_err.pyx in fiona.\_err.exc\_wrap\_pointer()


        CPLE\_OpenFailedError:   your file here  : No such file or directory

        
    During handling of the above exception, another exception occurred:


        DriverError                               Traceback (most recent call last)

        <ipython-input-6-63092016adbd> in <module>()
          1 \# running the function
          2 
    ----> 3 input\_gdf = gpd.read\_file('  your file here  ')
          4 poly\_name\_field = 'Counties'  \# or whatever is in the file
          5 poly\_name = 'San Diego' \# or whatever is in the file


        /opt/conda/lib/python3.6/site-packages/geopandas/io/file.py in read\_file(filename, bbox, **kwargs)
         69 
         70     with fiona\_env():
    ---> 71         with reader(path\_or\_bytes, **kwargs) as features:
         72             crs = features.crs
         73             if bbox is not None:


        /opt/conda/lib/python3.6/site-packages/fiona/env.py in wrapper(*args, **kwargs)
        395     def wrapper(*args, **kwargs):
        396         if local.\_env:
    --> 397             return f(*args, **kwargs)
        398         else:
        399             if isinstance(args[0], str):


        /opt/conda/lib/python3.6/site-packages/fiona/\_\_init\_\_.py in open(fp, mode, driver, schema, crs, encoding, layer, vfs, enabled\_drivers, crs\_wkt, **kwargs)
        251         if mode in ('a', 'r'):
        252             c = Collection(path, mode, driver=driver, encoding=encoding,
    --> 253                            layer=layer, enabled\_drivers=enabled\_drivers, **kwargs)
        254         elif mode == 'w':
        255             if schema:


        /opt/conda/lib/python3.6/site-packages/fiona/collection.py in \_\_init\_\_(self, path, mode, driver, schema, crs, encoding, layer, vsi, archive, enabled\_drivers, crs\_wkt, ignore\_fields, ignore\_geometry, **kwargs)
        157             if self.mode == 'r':
        158                 self.session = Session()
    --> 159                 self.session.start(self, **kwargs)
        160             elif self.mode in ('a', 'w'):
        161                 self.session = WritingSession()


        fiona/ogrext.pyx in fiona.ogrext.Session.start()


        fiona/\_shim.pyx in fiona.\_shim.gdal\_open\_vector()


        DriverError:   your file here  : No such file or directory

    \end{Verbatim}

    \begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\textbf{Problem 2.}

Food choices in low and medium income (LMI) neighborhoods are limited,
as these areas lack healthy food stores or other fresh food delivery
mechanisms. There may be more fast food stores than fresh produce shops.
Population is relatively poor, and filling the food basket with healthy
options hasn't been an overwhelming priority for many households. Such
areas are referred to as ``food deserts''.

See these articles: *
https://www.sandiegouniontribune.com/news/data-watch/sdut-san-diego-food-deserts-2016may15-htmlstory.html
(see food desert definitions here) *
https://www.npr.org/sections/thesalt/2013/03/13/174112591/how-to-find-a-food-desert-near-you
*
https://www.geospatial.institute/wp-content/uploads/2018/03/Mapping-Food-Desserts-in-Southern-California-Counties.pdf
*
https://www.sandiegoreader.com/news/2018/sep/04/stringers-imperial-beach-food-desert/\#
(a recent one, about IB) *
https://www.kpbs.org/news/2018/mar/29/sdsu-students-take-food-deserts-national-city/
* http://newscenter.sdsu.edu/sdsu\_newscenter/news\_story.aspx?sid=74890
* https://grist.org/food/americas-worst-food-deserts-map-lovers-edition/
* https://ucsdcommunityhealth.org/news/promoting-produce-consumption/

There was also a Master's thesis at UCSD:
https://escholarship.org/uc/item/0s78j9g2

Don't read them all, just skim to understand the issues and get ideas.

We'll analyze the current state of food deserts, using lists of
businesses that operate in San Diego, and social-demographic data from
SanDAG (by census tracts).

For the list of businesses, let's use City of San Diego tax
certificates: https://data.sandiego.gov/datasets/business-listings/.
These data are current, and include lat/lon. They also include detailed
NAICS codes for each business. This is the recommended dataset. We are
interested in active certificates. We are also interested in types of
businesses that are relevant to healthy (and unhealthy) food options.
Healthy food options would include FOOD (HEALTH) SUPPLEMENT STORES,
GROCERY STORES and GROCERY (EXCEPT CONVENIENCE) STORES. Unhealthy food
options would include FOOD SERVICES \& DRINKING PLACES, FULL-SERVICE
RESTAURANTS, LIMITED-SERVICE EATING PLACES, LIMITED-SERVICE RESTAURANTS
(a.k.a fast food places), BEER, WINE \& LIQUOR STORES, TOBACCO STORES,
CONVENIENCE STORES (a mixed bag\ldots{}). We have provided this as part
of the assignment. You don't need to download it, but you may if you
wish.

There is also ``SanDAG's point locations of business sites'' in San
Diego County (see metadata at
http://rdw.sandag.org/Account/GetFSFile.aspx?dir=Business\&Name=BUSINESS\_SITES.pdf).
This is already a shapefile, so this is a plus (but note disclaimers in
the metadata). The date is 8/17/2017, i.e.~not as current. Industry
codes are not as detailed as NAICS in the City's dataset.

We'll also get relevant spatial data layers from SanDAG: Promise Zone,
and census tract boundaries. Note that you'll need to create a free
account to access Sandag GIS data warehouse.

Descriptions of promise zones can be found at these links: *
https://www.hud.gov/sites/documents/SAN-DIEGO\_ZONE\_3RD.PDF *
https://www.sandiego.gov/economic-development/sdpromisezone/maps *
https://www.sandiego.gov/economic-development/sdpromisezone

To download the shapefiles, visit the SanDAG's ``Maps and GIS'' section:
* Promise Zone is under Business. Metadata at
http://rdw.sandag.org/Account/GetFSFile.aspx?dir=Business\&Name=Promise\_Zone\_SD.pdf.
Alternatively, you can use
https://data.sandiego.gov/datasets/promise-zone/ * Census tracts are
under Census. Metadata at
http://rdw.sandag.org/Account/GetFSFile.aspx?dir=Census\&Name=CENSUS\_TRACTS\_2010.pdf.

Social-demographic data by census tracts can be downloaded from SanDAG
at https://sandag.org/index.asp?classid=26\&fuseaction=home.classhome.
You can try to find the data yourself - but we also include an xlsx file
with some income statistics by census tracts.

San Diego County municipal boundaries (metadata at
http://rdw.sandag.org/Account/GetFSFile.aspx?dir=Jurisdiction\&Name=Municipal\_Boundaries.pdf)
can be downloaded from the same GIS Data Warehouse, under the
``Jurisdiction'' section. Alternatively, use
https://data.sandiego.gov/datasets/san-diego-boundary/ (we only need the
boundary of San Diego city, so the latter is quite sufficient.)

Your tasks:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Download the data - promise zone, census tracts, jurisdictions (census
  tracts social-demographic data and businesses data are provided but
  you can download as well if you wish), read them into geopandas
  dataframes, and merge social-demographic data with tract boundaries as
  needed.
\item
  Subset the businesses (figure out, from NAICS descriptions, which
  businesses are likely to provide healthy food options, and which
  unhealthy. You can use our suggestions above but also feel free to
  deviate from them as long as you justify your choices.)
\item
  Determine census tracts intersecting with the promise zone, and all
  other census tracts within the boundary of San Diego.
\item
  For each census tract marked as belonging to the promise zone, and the
  other tracts within the city limits, calculate the number of healthy
  and not-healthy options within that tract.
\item
  Compute the ratio of healthy and non-healthy options, and build a
  regression model showing how it depends on social-demographic
  characteristics, such as median income or number of people in lowest
  and highest income brackets. You may use sklearn on this dataframe by
  tracts to compute a linear regresson (as you did in DSC80. As a
  refresher, you may also check out
  https://towardsdatascience.com/simple-and-multiple-linear-regression-in-python-c928425168f9,
  https://towardsdatascience.com/linear-regression-in-python-9a1f5f000606,
  https://stackoverflow.com/questions/29934083/linear-regression-on-pandas-dataframe-using-sci-kit-learn/29937049).
  Provide a brief description of regression results.
\item
  Generate a map showing the ratio of healthy and not healthy food
  options, and the locations of stores offering healthy food options.
\item
  Extra Credit: Think of additional variables that you could bring into
  this analysis, and try to include them in the regression. ScaleSD is
  running a hackathon on this topic, and they have a good collection of
  data sources:
  https://www.scalesd.com/hackathon-2019/food-insecurity.html.
\end{enumerate}

We won't provide a skeleton for this problem. This is a much more open
project than before.

    \hypertarget{solution-for-problem-2-code-dataset-descriptions-discussion-of-regression-results}{%
\subsubsection{Solution for problem 2: code, dataset descriptions,
discussion of regression
results:}\label{solution-for-problem-2-code-dataset-descriptions-discussion-of-regression-results}}

    \textbf{Problem 2 dataset descriptions:}

promise: contains geo information for the San Diego Promise Zone that
spans the city's most disadvantaded and underserved communites.

census: contains the polygons representing the 2010 US Census Bureau
census tracts for San Diego county

juris: contains the different municipal jurisdictions for parcels,
roads, addresses in San DIego.

business: contains locations of business sites in San Diego County

social: contains social-demographic data by census tracts.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{}2}
         \PY{n}{business} \PY{o}{=} \PY{n}{business}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{business}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{account\PYZus{}status}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Active}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{health\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FOOD (HEALTH) SUPPLEMENT STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GROCERY STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GROCERY (EXCEPT CONVENIENCE) STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{unhealth\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FOOD SERVICES \PYZam{} DRINKING PLACES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FULL\PYZhy{}SERVICE RESTAURANTS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LIMITED\PYZhy{}SERVICE EATING PLACES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LIMITED\PYZhy{}SERVICE RESTAURANTS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BEER, WINE \PYZam{} LIQUOR STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TOBACCO STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CONVENIENCE STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{health} \PY{o}{=} \PY{n}{business}\PY{p}{[}\PY{n}{business}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{naics\PYZus{}description}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{health\PYZus{}list}\PY{p}{)}\PY{p}{]}
         \PY{n}{unhealth} \PY{o}{=} \PY{n}{business}\PY{p}{[}\PY{n}{business}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{naics\PYZus{}description}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{unhealth\PYZus{}list}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{}1}
         \PY{n}{promise} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../Promise\PYZus{}Zone\PYZus{}SD.shp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{census} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../CENSUS\PYZus{}TRACTS\PYZus{}2010.shp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{juris} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../MUNICIPAL\PYZus{}BOUNDARIES.shp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{business} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sd\PYZus{}businesses\PYZus{}active\PYZus{}since08\PYZus{}datasd.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{socio} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{socio\PYZhy{}demographic.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{socio}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TRACT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{socio}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TRACT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}
         \PY{n}{socio} \PY{o}{=} \PY{n}{socio}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print(type(socio[\PYZsq{}TRACT\PYZsq{}][0]))}
         \PY{n}{socio\PYZus{}census} \PY{o}{=} \PY{n}{census}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{socio}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{outer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TRACT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{census}
         \PY{n}{socio}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:}        TRACT  YEAR ORDINAL          INCOME GROUP HOUSEHOLDS
         0       1.00  2011       1     Less than \$15,000         64
         1       1.00  2011       2    \$15,000 to \$29,999          2
         2       1.00  2011       3    \$30,000 to \$44,999         12
         3       1.00  2011       4    \$45,000 to \$59,999        174
         4       1.00  2011       5    \$60,000 to \$74,999         97
         5       1.00  2011       6    \$75,000 to \$99,999        159
         6       1.00  2011       7  \$100,000 to \$124,999        198
         7       1.00  2011       8  \$125,000 to \$149,999         24
         8       1.00  2011       9  \$150,000 to \$199,999        225
         9       1.00  2011      10      \$200,000 or more        362
         10      1.00  2012       1     Less than \$15,000         12
         11      1.00  2012       2    \$15,000 to \$29,999         75
         12      1.00  2012       3    \$30,000 to \$44,999         89
         13      1.00  2012       4    \$45,000 to \$59,999        112
         14      1.00  2012       5    \$60,000 to \$74,999        112
         15      1.00  2012       6    \$75,000 to \$99,999        145
         16      1.00  2012       7  \$100,000 to \$124,999        208
         17      1.00  2012       8  \$125,000 to \$149,999         48
         18      1.00  2012       9  \$150,000 to \$199,999        164
         19      1.00  2012      10      \$200,000 or more        351
         20      1.00  2013       1     Less than \$15,000         10
         21      1.00  2013       2    \$15,000 to \$29,999         85
         22      1.00  2013       3    \$30,000 to \$44,999         58
         23      1.00  2013       4    \$45,000 to \$59,999         99
         24      1.00  2013       5    \$60,000 to \$74,999        104
         25      1.00  2013       6    \$75,000 to \$99,999        185
         26      1.00  2013       7  \$100,000 to \$124,999        220
         27      1.00  2013       8  \$125,000 to \$149,999         40
         28      1.00  2013       9  \$150,000 to \$199,999        218
         29      1.00  2013      10      \$200,000 or more        306
         {\ldots}      {\ldots}   {\ldots}     {\ldots}                   {\ldots}        {\ldots}
         43860  99.02  2014       1     Less than \$15,000          0
         43861  99.02  2014       2    \$15,000 to \$29,999          0
         43862  99.02  2014       3    \$30,000 to \$44,999          0
         43863  99.02  2014       4    \$45,000 to \$59,999          0
         43864  99.02  2014       5    \$60,000 to \$74,999          0
         43865  99.02  2014       6    \$75,000 to \$99,999          0
         43866  99.02  2014       7  \$100,000 to \$124,999          0
         43867  99.02  2014       8  \$125,000 to \$149,999          0
         43868  99.02  2014       9  \$150,000 to \$199,999          0
         43869  99.02  2014      10      \$200,000 or more          0
         43870  99.02  2015       1     Less than \$15,000          0
         43871  99.02  2015       2    \$15,000 to \$29,999          0
         43872  99.02  2015       3    \$30,000 to \$44,999          0
         43873  99.02  2015       4    \$45,000 to \$59,999          0
         43874  99.02  2015       5    \$60,000 to \$74,999          0
         43875  99.02  2015       6    \$75,000 to \$99,999          0
         43876  99.02  2015       7  \$100,000 to \$124,999          0
         43877  99.02  2015       8  \$125,000 to \$149,999          0
         43878  99.02  2015       9  \$150,000 to \$199,999          0
         43879  99.02  2015      10      \$200,000 or more          0
         43880  99.02  2016       1     Less than \$15,000          0
         43881  99.02  2016       2    \$15,000 to \$29,999          0
         43882  99.02  2016       3    \$30,000 to \$44,999          0
         43883  99.02  2016       4    \$45,000 to \$59,999          0
         43884  99.02  2016       5    \$60,000 to \$74,999          0
         43885  99.02  2016       6    \$75,000 to \$99,999          0
         43886  99.02  2016       7  \$100,000 to \$124,999          0
         43887  99.02  2016       8  \$125,000 to \$149,999          0
         43888  99.02  2016       9  \$150,000 to \$199,999          0
         43889  99.02  2016      10      \$200,000 or more          0
         
         [43890 rows x 5 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{}3}
         \PY{n}{cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{sub\PYZus{}regions} \PY{o}{=} \PY{n}{juris}\PY{p}{[}\PY{n}{cols}\PY{p}{]}\PY{o}{.}\PY{n}{dissolve}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{aggfunc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{as\PYZus{}index} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{sd} \PY{o}{=} \PY{n}{sub\PYZus{}regions}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{sub\PYZus{}regions}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NAME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SAN DIEGO}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{sd}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:}          NAME                                           geometry
         15  SAN DIEGO  (POLYGON ((6470708.438250005 1829214.123249993{\ldots}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}3}
         \PY{n}{polygons} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{polygon} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{)}
         \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{rows} \PY{o+ow}{in} \PY{n}{census}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{k}{for} \PY{n}{j}\PY{p}{,} \PY{n}{ro} \PY{o+ow}{in} \PY{n}{sd}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print(i.geometry)}
            \PY{c+c1}{\PYZsh{} print(sd[\PYZsq{}geometry\PYZsq{}])}
                 \PY{k}{if} \PY{n}{ro}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{contains}\PY{p}{(}\PY{n}{rows}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{dict1} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                     \PY{n}{dict1}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{n}{rows}\PY{p}{)}
                     \PY{n}{polygons}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict1}\PY{p}{)}
                     \PY{c+c1}{\PYZsh{}polygons.append(ro[\PYZsq{}geometry\PYZsq{}].intersects(rows[\PYZsq{}geometry\PYZsq{}]))}
         \PY{n}{polygons}  
         \PY{n}{polygon} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{polygons}\PY{p}{)}
         \PY{n}{polygon}
         
         \PY{n}{lst} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{k} \PY{p}{,} \PY{n}{polygon\PYZus{}city} \PY{o+ow}{in} \PY{n}{polygon}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{k}{for} \PY{n}{l}\PY{p}{,} \PY{n}{po\PYZus{}city} \PY{o+ow}{in} \PY{n}{promise}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{n}{po\PYZus{}city}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{intersects}\PY{p}{(}\PY{n}{polygon\PYZus{}city}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{lst}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{po\PYZus{}city}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{intersects}\PY{p}{(}\PY{n}{polygon\PYZus{}city}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{lst}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PROMISE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lst}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{business} \PY{o}{=} \PY{n}{business}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{business}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{account\PYZus{}status}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Active}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{health\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FOOD (HEALTH) SUPPLEMENT STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GROCERY STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GROCERY (EXCEPT CONVENIENCE) STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{unhealth\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FOOD SERVICES \PYZam{} DRINKING PLACES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FULL\PYZhy{}SERVICE RESTAURANTS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LIMITED\PYZhy{}SERVICE EATING PLACES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LIMITED\PYZhy{}SERVICE RESTAURANTS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BEER, WINE \PYZam{} LIQUOR STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TOBACCO STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CONVENIENCE STORES}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{health} \PY{o}{=} \PY{n}{business}\PY{p}{[}\PY{n}{business}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{naics\PYZus{}description}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{health\PYZus{}list}\PY{p}{)}\PY{p}{]}
         \PY{n}{unhealth} \PY{o}{=} \PY{n}{business}\PY{p}{[}\PY{n}{business}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{naics\PYZus{}description}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{unhealth\PYZus{}list}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{}4}
         \PY{k+kn}{from} \PY{n+nn}{shapely}\PY{n+nn}{.}\PY{n+nn}{geometry} \PY{k}{import} \PY{n}{Point}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{n}{health}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{health}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
         \PY{n}{health} \PY{o}{=} \PY{n}{health}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{health}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{health}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{Point}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{float}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{unhealth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{unhealth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
         \PY{n}{unhealth} \PY{o}{=} \PY{n}{unhealth}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{unhealth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geometry}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{unhealth}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{Point}\PY{p}{(}\PY{n+nb}{float}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{float}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{health}\PY{o}{.}\PY{n}{crs} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{init}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{epsg:4326}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
         \PY{n}{health} \PY{o}{=} \PY{n}{health}\PY{o}{.}\PY{n}{to\PYZus{}crs}\PY{p}{(}\PY{n}{epsg}\PY{o}{=}\PY{l+m+mi}{2230}\PY{p}{)}
         \PY{n}{unhealth}\PY{o}{.}\PY{n}{crs} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{init}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{epsg:4326}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
         \PY{n}{unhealth} \PY{o}{=} \PY{n}{unhealth}\PY{o}{.}\PY{n}{to\PYZus{}crs}\PY{p}{(}\PY{n}{epsg}\PY{o}{=}\PY{l+m+mi}{2230}\PY{p}{)}
         \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{tract} \PY{o+ow}{in} \PY{n}{polygon}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{num\PYZus{}health} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{num\PYZus{}unhealth} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{k}{for} \PY{n}{j}\PY{p}{,} \PY{n}{food} \PY{o+ow}{in} \PY{n}{health}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{}print((tract.geometry))}
                 \PY{k}{if} \PY{p}{(}\PY{n}{food}\PY{o}{.}\PY{n}{geometry}\PY{p}{)}\PY{o}{.}\PY{n}{within}\PY{p}{(}\PY{n}{tract}\PY{o}{.}\PY{n}{geometry}\PY{p}{)}\PY{p}{:}
                     \PY{c+c1}{\PYZsh{}print(food.geometry)}
                     \PY{n}{num\PYZus{}health}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
             \PY{k}{for} \PY{n}{x}\PY{p}{,} \PY{n}{xfood} \PY{o+ow}{in} \PY{n}{unhealth}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{xfood}\PY{o}{.}\PY{n}{geometry}\PY{p}{)}\PY{o}{.}\PY{n}{within}\PY{p}{(}\PY{n}{tract}\PY{o}{.}\PY{n}{geometry}\PY{p}{)}\PY{p}{:}
                     \PY{n}{num\PYZus{}unhealth}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
             \PY{n}{polygon}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{num\PYZus{}health}
             \PY{n}{polygon}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unhealth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{num\PYZus{}unhealth}
         \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{p}{(}\PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unhealth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unhealth\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unhealth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{p}{(}\PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unhealth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{polygon}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/opt/conda/lib/python3.6/site-packages/ipykernel\_launcher.py:4: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  after removing the cwd from sys.path.
/opt/conda/lib/python3.6/site-packages/ipykernel\_launcher.py:7: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\_indexer,col\_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  import sys

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:}        SHAPE\_AREA     SHAPE\_LEN   TRACT  \textbackslash{}
         0    8.693887e+06  12443.272111   15.00   
         1    7.407379e+06  11329.616060   16.00   
         2    6.714940e+06  10791.678584   17.00   
         3    8.036708e+06  13929.689427   18.00   
         4    1.796665e+07  21026.710682   19.00   
         5    2.647745e+07  24466.212488   20.01   
         6    1.358501e+07  18914.448722   20.02   
         7    9.573967e+06  16764.302881   21.00   
         8    3.846679e+06   7952.530281   22.01   
         9    5.240834e+06   9241.379223   22.02   
         10   4.556667e+06  10260.454775   23.01   
         11   5.692262e+06   9700.106802   23.02   
         12   7.000365e+06  10779.956048   24.01   
         13   5.422545e+06   9694.763433   24.02   
         14   1.321469e+07  16982.283317   25.01   
         15   2.048719e+07  22492.150409   25.02   
         16   9.025954e+06  12362.042379   26.01   
         17   8.258565e+06  11978.277372   26.02   
         18   1.463803e+07  15777.106779   27.02   
         19   1.656757e+07  19820.936427    1.00   
         20   8.250975e+06  11854.098818    2.01   
         21   1.370893e+07  18073.476045    2.02   
         22   9.790827e+06  14614.226517    3.00   
         23   1.300128e+07  16192.890032    4.00   
         24   1.200189e+07  17097.671388    5.00   
         25   9.854327e+06  15285.724216    6.00   
         26   8.293416e+06  11537.818851    7.00   
         27   6.823123e+06  10592.794745    8.00   
         28   6.691737e+06  10359.599145    9.00   
         29   8.586100e+06  13160.949804   10.00   
         ..            {\ldots}           {\ldots}     {\ldots}   
         183  1.853100e+07  21444.321895   92.01   
         184  3.856647e+07  30900.598608   92.02   
         185  1.729097e+07  20605.362325   93.01   
         186  6.392176e+07  45104.872869   93.04   
         187  1.661303e+07  18567.032460   93.05   
         188  3.058961e+07  24304.194127   93.06   
         189  1.370451e+07  14887.300073  100.03   
         190  1.527347e+07  19939.078877  100.04   
         191  1.607133e+07  18235.993645  100.05   
         192  1.259329e+07  15373.230171  100.10   
         193  9.527102e+06  13187.716278  100.11   
         194  6.770237e+06  11287.394002  100.12   
         195  9.659651e+06  15220.770077  100.13   
         196  1.446260e+07  16852.556174  101.06   
         197  2.363639e+07  23859.133315  101.10   
         198  6.381828e+06  11701.203604  101.11   
         199  8.619309e+06  13440.475521  101.12   
         200  4.069061e+07  28172.688387  170.46   
         201  2.296229e+07  23599.462449  170.47   
         202  2.365592e+07  22960.729732  170.52   
         203  5.130909e+07  33419.346829  170.15   
         204  1.964096e+07  30003.088551  170.18   
         205  1.139311e+07  14846.892936  170.31   
         206  3.059874e+07  27690.721613  170.34   
         207  2.513437e+07  25511.445724  170.35   
         208  1.072296e+07  14750.305801  170.36   
         209  3.415707e+07  24280.351461  170.37   
         210  3.247074e+07  25765.410388  170.43   
         211  2.970188e+07  32172.650855  170.56   
         212  3.699670e+07  33041.186525  214.00   
         
                                                       geometry  PROMISE  health  \textbackslash{}
         0    POLYGON ((6293438.094999999 1853304.829999998,{\ldots}    False     1.0   
         1    POLYGON ((6292472.284999996 1855719.495000005,{\ldots}    False     1.0   
         2    POLYGON ((6292613.597000003 1857793.034999996,{\ldots}    False     0.0   
         3    POLYGON ((6297364.831 1858582.739749998, 62973{\ldots}    False     0.0   
         4    POLYGON ((6296136.003000006 1863452.471000001,{\ldots}    False     0.0   
         5    POLYGON ((6300085.164250001 1864216.240999997,{\ldots}    False     0.0   
         6    POLYGON ((6304729.081 1859783.018999994, 63047{\ldots}    False     0.0   
         7    POLYGON ((6298904.605250001 1858676.689999998,{\ldots}    False     0.0   
         8    POLYGON ((6297138.586999997 1855642.806999996,{\ldots}    False     2.0   
         9    POLYGON ((6300053.025000006 1853724.276999995,{\ldots}    False     0.0   
         10   POLYGON ((6302384.902999997 1856950.949249998,{\ldots}    False     1.0   
         11   POLYGON ((6302737.768999994 1855836.872999996,{\ldots}    False     3.0   
         12   POLYGON ((6294239.298749998 1853697.294, 62943{\ldots}    False     1.0   
         13   POLYGON ((6297431.069000006 1853639.170000002,{\ldots}    False     1.0   
         14   POLYGON ((6296443.011999995 1851616.996999994,{\ldots}    False     1.0   
         15   POLYGON ((6299897.452000007 1850223.407250002,{\ldots}    False     0.0   
         16   POLYGON ((6302667.186000004 1850182.355000004,{\ldots}    False     2.0   
         17   POLYGON ((6300986.321250007 1850181.787249997,{\ldots}    False     0.0   
         18   POLYGON ((6307797.069000006 1852858.980000004,{\ldots}    False     0.0   
         19   POLYGON ((6273121 1857292, 6273168.000249997 1{\ldots}    False     0.0   
         20   POLYGON ((6278383.999750003 1856813, 6278375 1{\ldots}    False     0.0   
         21   POLYGON ((6276705.420750007 1854067.768000007,{\ldots}    False     0.0   
         22   POLYGON ((6279822.865999997 1853534.077999994,{\ldots}    False     0.0   
         23   POLYGON ((6281407.650000006 1857087.834999993,{\ldots}    False     1.0   
         24   POLYGON ((6287139.963 1859651.998750001, 62871{\ldots}    False     0.0   
         25   POLYGON ((6282762.033999994 1856530.594999999,{\ldots}    False     0.0   
         26   POLYGON ((6285023.987000003 1853290.105000004,{\ldots}    False     0.0   
         27   POLYGON ((6286120.351750001 1853275.568000004,{\ldots}    False     0.0   
         28   POLYGON ((6286578.569000006 1855755.341000006,{\ldots}    False     0.0   
         29   POLYGON ((6288467.393999994 1858507.796000004,{\ldots}    False     0.0   
         ..                                                 {\ldots}      {\ldots}     {\ldots}   
         183  POLYGON ((6285427.626750007 1875531.202000007,{\ldots}    False     0.0   
         184  POLYGON ((6289348.282000005 1868140.759000003,{\ldots}    False     0.0   
         185  POLYGON ((6291516.937749997 1872521.098000005,{\ldots}    False     0.0   
         186  POLYGON ((6295922.665000007 1866997.622999996,{\ldots}    False     1.0   
         187  POLYGON ((6291860.589000002 1872495.277999997,{\ldots}    False     0.0   
         188  POLYGON ((6296170.497999996 1875169.658000007,{\ldots}    False     0.0   
         189  POLYGON ((6317158.150999993 1793084.008000001,{\ldots}    False     0.0   
         190  POLYGON ((6312532.663749993 1789310.302000001,{\ldots}    False     0.0   
         191  POLYGON ((6312407.921000004 1787448.667750001,{\ldots}    False     1.0   
         192  POLYGON ((6309990.012999997 1793169.941750005,{\ldots}    False     0.0   
         193  POLYGON ((6311816.913000003 1793145.854000002,{\ldots}    False     0.0   
         194  POLYGON ((6313826.233999997 1782825.034999996,{\ldots}    False     0.0   
         195  POLYGON ((6316026.807249993 1783836.768000007,{\ldots}    False     2.0   
         196  POLYGON ((6309406.862000003 1790659.877000004,{\ldots}    False     1.0   
         197  POLYGON ((6302781.144999996 1793246.160750002,{\ldots}    False     0.0   
         198  POLYGON ((6311362.870000005 1786943.023000002,{\ldots}    False     1.0   
         199  POLYGON ((6306851.180999994 1787962.010000005,{\ldots}    False     0.0   
         200  POLYGON ((6306006.596750006 1917006.486750007,{\ldots}    False     0.0   
         201  POLYGON ((6310406.885000005 1916547.369000003,{\ldots}    False     0.0   
         202  POLYGON ((6310150.388999999 1941673.481250003,{\ldots}    False     0.0   
         203  POLYGON ((6313214.996250004 1952968.827000007,{\ldots}    False     0.0   
         204  POLYGON ((6302959.295000002 1933004.047000006,{\ldots}    False     0.0   
         205  POLYGON ((6307679.030750006 1956038.209999993,{\ldots}    False     0.0   
         206  POLYGON ((6306012.782000005 1943987.339000002,{\ldots}    False     0.0   
         207  POLYGON ((6301372.155000001 1932717.834000006,{\ldots}    False     0.0   
         208  POLYGON ((6292005.136000007 1928054.346000001,{\ldots}    False     0.0   
         209  POLYGON ((6298423.827999994 1924763.974000007,{\ldots}    False     0.0   
         210  POLYGON ((6301997.247999996 1921570.643999994,{\ldots}    False     0.0   
         211  POLYGON ((6306539.344249994 1933740.116999999,{\ldots}    False     2.0   
         212  POLYGON ((6267097.392749995 1848889.701250002,{\ldots}    False     1.0   
         
              unhealth  health\_ratio  unhealth\_ratio  
         0         3.0      0.250000        0.750000  
         1         2.0      0.333333        0.666667  
         2         2.0      0.000000        1.000000  
         3        15.0      0.000000        1.000000  
         4         0.0           NaN             NaN  
         5         0.0           NaN             NaN  
         6         0.0           NaN             NaN  
         7        10.0      0.000000        1.000000  
         8         3.0      0.400000        0.600000  
         9         8.0      0.000000        1.000000  
         10        8.0      0.111111        0.888889  
         11       12.0      0.200000        0.800000  
         12        5.0      0.166667        0.833333  
         13        5.0      0.166667        0.833333  
         14        0.0      1.000000        0.000000  
         15        1.0      0.000000        1.000000  
         16        8.0      0.200000        0.800000  
         17        1.0      0.000000        1.000000  
         18        9.0      0.000000        1.000000  
         19        0.0           NaN             NaN  
         20        5.0      0.000000        1.000000  
         21        5.0      0.000000        1.000000  
         22       23.0      0.000000        1.000000  
         23       21.0      0.045455        0.954545  
         24        2.0      0.000000        1.000000  
         25       17.0      0.000000        1.000000  
         26       10.0      0.000000        1.000000  
         27        3.0      0.000000        1.000000  
         28       10.0      0.000000        1.000000  
         29       10.0      0.000000        1.000000  
         ..        {\ldots}           {\ldots}             {\ldots}  
         183       0.0           NaN             NaN  
         184       2.0      0.000000        1.000000  
         185       3.0      0.000000        1.000000  
         186      33.0      0.029412        0.970588  
         187       0.0           NaN             NaN  
         188       5.0      0.000000        1.000000  
         189       0.0           NaN             NaN  
         190       0.0           NaN             NaN  
         191       1.0      0.500000        0.500000  
         192       4.0      0.000000        1.000000  
         193       2.0      0.000000        1.000000  
         194       2.0      0.000000        1.000000  
         195       3.0      0.400000        0.600000  
         196       5.0      0.166667        0.833333  
         197       3.0      0.000000        1.000000  
         198       3.0      0.250000        0.750000  
         199       0.0           NaN             NaN  
         200       0.0           NaN             NaN  
         201       0.0           NaN             NaN  
         202       4.0      0.000000        1.000000  
         203       4.0      0.000000        1.000000  
         204       4.0      0.000000        1.000000  
         205       2.0      0.000000        1.000000  
         206       0.0           NaN             NaN  
         207       0.0           NaN             NaN  
         208       9.0      0.000000        1.000000  
         209       3.0      0.000000        1.000000  
         210      11.0      0.000000        1.000000  
         211      14.0      0.125000        0.875000  
         212      38.0      0.025641        0.974359  
         
         [213 rows x 9 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{}5}
         \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{linear\PYZus{}model} \PY{k}{as} \PY{n}{lm}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{Pipeline}
         \PY{k+kn}{import} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{as} \PY{n+nn}{pp}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{compose} \PY{k}{import} \PY{n}{ColumnTransformer}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         
         \PY{n}{feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ORDINAL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TRACT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{healthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unhealth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{socio\PYZus{}poly} \PY{o}{=} \PY{n}{polygon}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{socio}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{outer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TRACT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{socio\PYZus{}poly} \PY{o}{=} \PY{n}{socio\PYZus{}poly}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{prom} \PY{o}{=} \PY{n}{socio\PYZus{}poly}\PY{p}{[}\PY{n}{socio\PYZus{}poly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PROMISE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{k+kc}{True} \PY{p}{]}
         \PY{n}{other} \PY{o}{=} \PY{n}{socio\PYZus{}poly}\PY{p}{[}\PY{n}{socio\PYZus{}poly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PROMISE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{k+kc}{False} \PY{p}{]}
         
         \PY{n}{promX} \PY{o}{=} \PY{n}{prom}\PY{p}{[}\PY{n}{feats}\PY{p}{]}
         \PY{n}{promY} \PY{o}{=} \PY{n}{prom}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{otherX} \PY{o}{=} \PY{n}{other}\PY{p}{[}\PY{n}{feats}\PY{p}{]}
         \PY{n}{otherY} \PY{o}{=} \PY{n}{other}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{promX}\PY{p}{,} \PY{n}{promY}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{cat\PYZus{}transformer} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{n}{steps}\PY{o}{=}\PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{onehot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pp}\PY{o}{.}\PY{n}{OneHotEncoder}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{n}{preproc} \PY{o}{=} \PY{n}{ColumnTransformer}\PY{p}{(}\PY{n}{transformers}\PY{o}{=}\PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cat\PYZus{}transformer}\PY{p}{,} \PY{n}{feats}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{n}{lin\PYZus{}reg} \PY{o}{=} \PY{n}{lm}\PY{o}{.}\PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
         \PY{n}{pl} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{n}{steps}\PY{o}{=}\PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{preprocessor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{preproc}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lin\PYZus{}reg}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{n}{pl}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
         \PY{n}{score} \PY{o}{=} \PY{n}{pl}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Regression score for tracts within the promise zone: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{score}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{otherX}\PY{p}{,} \PY{n}{otherY}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{cat\PYZus{}transformer} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{n}{steps}\PY{o}{=}\PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{onehot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pp}\PY{o}{.}\PY{n}{OneHotEncoder}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{n}{preproc} \PY{o}{=} \PY{n}{ColumnTransformer}\PY{p}{(}\PY{n}{transformers}\PY{o}{=}\PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cat\PYZus{}transformer}\PY{p}{,} \PY{n}{feats}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{n}{lin\PYZus{}reg} \PY{o}{=} \PY{n}{lm}\PY{o}{.}\PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
         \PY{n}{pl} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{n}{steps}\PY{o}{=}\PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{preprocessor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{preproc}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lin\PYZus{}reg}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{n}{pl}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
         \PY{n}{score} \PY{o}{=} \PY{n}{pl}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Regression score for tracts outside the promise zone: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{score}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Regression score for tracts within the promise zone: 0.8494166500714084
Regression score for tracts outside the promise zone: 0.28979887824235856

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/datasets/home/88/788/hnavnitl/.local/lib/python3.6/site-packages/sklearn/preprocessing/\_encoders.py:371: FutureWarning: The handling of integer data will change in version 0.22. Currently, the categories are determined based on the range [0, max(values)], while in the future they will be determined based on the unique values.
If you want the future behaviour and silence this warning, you can specify "categories='auto'".
In case you used a LabelEncoder before this OneHotEncoder to convert the categories to integers, then you can now use the OneHotEncoder directly.
  warnings.warn(msg, FutureWarning)
/datasets/home/88/788/hnavnitl/.local/lib/python3.6/site-packages/sklearn/preprocessing/\_encoders.py:371: FutureWarning: The handling of integer data will change in version 0.22. Currently, the categories are determined based on the range [0, max(values)], while in the future they will be determined based on the unique values.
If you want the future behaviour and silence this warning, you can specify "categories='auto'".
In case you used a LabelEncoder before this OneHotEncoder to convert the categories to integers, then you can now use the OneHotEncoder directly.
  warnings.warn(msg, FutureWarning)

    \end{Verbatim}

    \#5 description The classifier score for applying a linear regression to
tracts within the promise zone was 0.856366 while the score for applying
a linear regression to tracts outside of the promise zone was 0.30966.
This can indicate that for areas within the promise zone, income level
and geographic location are closely correlated with the ratio of healthy
restaurants that exist in the area while the same cannot be said for
areas outside of the promise zone. However, we should take pause in
coming to this conclusion due to the fact that we had very little
applicable healthy and non-healthy restaurant data, resulting in many
healthy ratios ending up being 0 due to not having found any healthy or
unhealthy restaurants in the business dataset. This could lead to
reduced reliability in the conclusions we can draw from this regression
study.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{}6}
         \PY{k+kn}{from} \PY{n+nn}{geopandas} \PY{k}{import} \PY{n}{GeoDataFrame}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{c+c1}{\PYZsh{}import GeoDataFrame}
         
         \PY{n}{polygon} \PY{o}{=} \PY{n}{GeoDataFrame}\PY{p}{(}\PY{n}{polygon}\PY{p}{,} \PY{n}{geometry} \PY{o}{=} \PY{n}{polygon}\PY{o}{.}\PY{n}{geometry}\PY{p}{)}  \PY{c+c1}{\PYZsh{}, crs=crs, geometry = polygon.geometry)}
         \PY{n}{map\PYZus{}df} \PY{o}{=} \PY{n}{polygon}
         \PY{n}{map\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
         \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unhealth\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{polygon}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unhealth\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}map\PYZus{}df.plot()}
         
         \PY{n}{variable} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unhealth\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{vmin}\PY{p}{,} \PY{n}{vmax} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}
         
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         \PY{n}{a} \PY{o}{=} \PY{n}{map\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{column} \PY{o}{=} \PY{n}{variable}\PY{p}{,} \PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BuGn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linewidth} \PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{edgecolor} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{0.8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}fig, ax = plt.subplot(1, figsize = (10,6))}
         \PY{n}{ax}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{off}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ratio of the Unhealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{color\PYZus{}bar} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{ScalarMappable}\PY{p}{(}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BuGn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{norm}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{Normalize}\PY{p}{(}\PY{n}{vmin}\PY{o}{=}\PY{n}{vmin}\PY{p}{,} \PY{n}{vmax}\PY{o}{=}\PY{n}{vmax}\PY{p}{)}\PY{p}{)}
         \PY{n}{color\PYZus{}bar}\PY{o}{.}\PY{n}{\PYZus{}A} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}health.plot(ax = a, marker=\PYZsq{}*\PYZsq{}, color=\PYZsq{}black\PYZsq{}, markersize = 2)}
         \PY{c+c1}{\PYZsh{}health.plot(ax = a, marker=\PYZsq{}*\PYZsq{}, color=\PYZsq{}black\PYZsq{}, markersize = 10)}
         \PY{n}{b} \PY{o}{=} \PY{n}{health}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax} \PY{o}{=} \PY{n}{a}\PY{p}{,} \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{markersize} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print(health)}
         \PY{c+c1}{\PYZsh{}health.plot(ax = a, marker = \PYZsq{}o\PYZsq{}, color = \PYZsq{}k\PYZsq{}, markersize = 10)}
         \PY{n}{col\PYZus{}bar} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{color\PYZus{}bar}\PY{p}{)} 
         \PY{n}{promise}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax} \PY{o}{=} \PY{n}{b}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{edgecolor} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}promise.plot(ax = b, linewidth = 0.15)}
         \PY{c+c1}{\PYZsh{}promise.plot(ax = b, linewidth = 0.5)}
         \PY{c+c1}{\PYZsh{}promise.plot(ax = b, color = \PYZsq{}None\PYZsq{}, edgecolor = \PYZsq{}black\PYZsq{})}
         \PY{c+c1}{\PYZsh{}promise.plot(ax = b, color = \PYZsq{}None\PYZsq{}, edgecolor = \PYZsq{}c\PYZsq{})}
         \PY{c+c1}{\PYZsh{}promise.plot(ax = b, color = \PYZsq{}None\PYZsq{}, edgecolor = \PYZsq{}black\PYZsq{}, linewidth = 0.15)}
         \PY{c+c1}{\PYZsh{}promise.plot(ax = b, color = \PYZsq{}None\PYZsq{}, edgecolor = \PYZsq{}blue\PYZsq{}, linewidth = 0.10)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x7fe50e641710>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{c+c1}{\PYZsh{} YOUR CODE HERE}
         \PY{k}{raise} \PY{n+ne}{NotImplementedError}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        NotImplementedError                       Traceback (most recent call last)

        <ipython-input-25-15b94d1fa268> in <module>()
          1 \# YOUR CODE HERE
    ----> 2 raise NotImplementedError()
    

        NotImplementedError: 

    \end{Verbatim}

    \textbf{Problem 2 discussion of linear regression results:}

    \hypertarget{responses-to-the-extra-credit-questions}{%
\subsection{Responses to the extra credit
questions:}\label{responses-to-the-extra-credit-questions}}

Your text here

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{c+c1}{\PYZsh{} YOUR CODE HERE}
         \PY{k}{raise} \PY{n+ne}{NotImplementedError}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        NotImplementedError                       Traceback (most recent call last)

        <ipython-input-26-15b94d1fa268> in <module>()
          1 \# YOUR CODE HERE
    ----> 2 raise NotImplementedError()
    

        NotImplementedError: 

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{c+c1}{\PYZsh{} Please let us know how much time you spent on this project, in hours: }
         \PY{c+c1}{\PYZsh{} (we will only examine distributions and won\PYZsq{}t look at individual responses)}
         \PY{n}{assignment\PYZus{}timespent} \PY{o}{=} 
         \PY{n}{extracredit\PYZus{}timespent} \PY{o}{=} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

          File "<ipython-input-27-eba14017751e>", line 3
        assignment\_timespent =
                               \^{}
    SyntaxError: invalid syntax


    \end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
